- [C++——STL 之 vector, list, deque 容器对比与常用函数 - 寒江小筑 - 博客园](https://www.cnblogs.com/yrm1160029237/p/10291315.html)
- [C++三种容器：list、vector 和 deque 的区别-CSDN 博客](https://blog.csdn.net/gogokongyin/article/details/51178378)
- [面试官都在问 | 请谈谈 vector 的底层实现-CSDN 博客](https://blog.csdn.net/gjggj/article/details/114365071)

# 一、vector

### 1.1 vector 介绍

> vector 定义二维数组并初始化为 0
>
> ```cpp
> vector<vector<int>> v(size1, vector<int>(size2, 0));
> ```

- vector 是连续存储结构(内部数据结构为数组)，每个元素在内存上时连续的(类似于数组，但数组容量不能扩充而 vector 可以进行扩充)
- 支持高效随机访问和尾部插入/删除操作，其他位置的插入/删除操作效率较低
- vector 迭代器失效的情况
  - vector 内存重新分配时原本迭代器失效
  - 插入/删除元素时，指向被插入/删除元素以后任何元素原本的迭代器都失效

### 1.2 vector 内存分配原理

- 首先预分配一个非常大的内存空间进行存储(capacity()返回的值)
- 当超过此预分配空间时再重新分配内存并将原本内存的元素复制到新内存进行存储，同时释放原本的空间 -->内存重新分配按照 2 倍方式进行扩容
- vector 内存扩容步骤
  - 开辟新的内存空间
  - 拷贝旧内存空间元素到新内存空间
  - 释放旧内存空间元素

# 二、list

### 2.1 list 介绍

- list 是非连续存储结构(内部数据结构为双向环状链表)，可动态增加和减少元素
- 不支持随机访问，但支持双向遍历，支持在任何地方高效插入/删除元素
- list 在增加元素时迭代器不会失效，但删除元素时，指向当前被删除元素的迭代器失效，其余也不会失效

### 2.2 list 优缺点

##### 2.2.1 list 优点

- 采用非连续内存实现动态增减元素
- 插入/删除操作方便高效

##### 2.2.2 list 缺点

- 不支持元素的随机访问
- 相较于 vector 内存占用较多(维护指针等开销较大)

# 三、deque

### 3.1 deque 介绍

- deque 是连续存储结构(内部数据结构为数组)，类似于 vector，但与 vector 不同的是 deque 采用了两级数组结构，第一级数组结构类似于 vector 的数组结构，存储实际元素；第二级维护容器的首地址，便于支持高效的首尾插入/删除操作
- 中控器对应二级数组，缓冲区对应一级数组
  ![](https://img-blog.csdnimg.cn/img_convert/69c03852cc2db911554f35298a3e1fdb.png)
- 支持高效随机访问
- deque 迭代器失效情况
  - 在头尾插入元素可能会使其他迭代器失效，但在其他位置插入元素一定会使其他迭代器失效
  - 在 deque 中间删除元素会使所有迭代器失效
  - 在 deque 首尾删除元素时，只使指向该元素的迭代器失效，其他元素迭代器不会失效

### 3.2 deque 优缺点

##### 3.2.1 deque 优点

- 高效随机访问，首尾插入删除操作效率高

##### 3.2.2 deque 缺点

- 占用内存较多

# 四、vector、list 和 deque 对比

### 4.1 使用区别

- 需要高效随机访问而不关心插入和删除效率：vector
- 需要大量插入删除而不关心高效随机访问：list
- 需要高效随机访问但关心首尾数据的插入删除：deque(list 和 vector 的折中)

### 4.2 特性区别

- vector 内存空间连续，容量可动态增加，支持高效随机访问且尾部插入删除效率高；但其他位置插入删除效率较低
- list 内存空间不连续，不支持随机访问；但任意位置插入删除效率很高
- deque 内存空间是多个连续内存块，支持随机访问但效率不如 vector 高，首尾插入效率高；但其他位置插入删除效率较低
