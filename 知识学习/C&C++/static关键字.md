[C 语言关键字 static 的使用方法](https://mp.weixin.qq.com/s/_-WX6hAVh9N-8924mGDXZw)

# 一、static 变量

### 一、静态全局变量、全局变量

> 静态全局变量、全局变量的区别主要通过**生存周期和作用域**来区别

|                |        全局变量        |      静态全局变量      |
| :------------: | :--------------------: | :--------------------: |
|    生存周期    | 程序运行开始到程序结束 | 程序运行开始到程序结束 |
|     作用域     | 程序中所有代码均能访问 |  只有当前文件可以访问  |
| 代码段中的位置 |       全局数据区       |       全局数据区       |

- 静态局部变量在函数内定义，生存期为整个源程序，但作用域与局部变量相同。退出该函数后， 尽管该静态局部变量存在但不能被使用
- 对基本类型的静态局部变量若在定义时未给定初值，则系统自动赋值为 0

### 二、静态局部变量、局部变量

> 静态局部变量、局部变量的区别主要通过**生存周期和作用域**来区别

|                |      局部变量      |      静态局部变量      |
| :------------: | :----------------: | :--------------------: |
|    生存周期    | 函数调用到函数返回 | 程序运行开始到程序结束 |
|     作用域     |      函数内部      |        函数内部        |
| 代码段中的位置 |         栈         |       全局数据区       |

- 静态局部变量和局部变量都只能在函数体内部才可以访问
- 函数每次访问的静态局部变量的值为上一次访问修改后的值
- 局部变量每次调用都会重新在栈中初始化，而静态局部变量只初始化一次，后续每次访问的值都是上一次访问修改后的值

静态局部对象只在控制流第一次越过它们的声明时构造，因此下面的`new Fred()`语句只会执行一次：即在`x()`被第一次调用时执行`new Fred()`语句。后续每次调用`x()`将返回同一个`Fred`对象

```cpp
#include "Fred.hpp"

Fred& x()
{
	static Fred* ans = new Fred();
	return *ans;
}
```

# 二、static 函数

> 在函数的返回类型前加上关键字 static，函数就被定义成为静态函数
> 函数的定义和声明默认情况下是 extern 的，但静态函数只在声明他的文件当中可见，对于其他文件来说不可见
> static 函数（也叫内部函数）只能被同一文件中的函数所调用，不能被其它文件中的函数调用

定义静态函数的好处：

- 其他文件中可以定义相同名字的函数，不会发生冲突 -> 访问控制
