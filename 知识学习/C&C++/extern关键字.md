- [extern “C”的作用详解](https://www.cnblogs.com/xiangtingshen/p/10980055.html)
- [C/C++中的 extern 和 extern“C“关键字的理解和使用（对比两者的异同）](https://blog.csdn.net/m0_46606290/article/details/119973574)

# 一、extern 关键字

> 针对变量的声明，变量定义需要开辟内存而变量声明不需要开辟内存

```cpp
int i = 0;    // 定义变量i
extern int i;    // 声明变量i
```

### 1.1 使用 extern 声明变量，使在其他文件定义的变量在当前使用 extern 声明的文件中能被访问到

```c
----a.c-----
int a = 0;
----main.c-----
extern int a;
```

使用 extern 对变量进行声明后，如果在当前文件找不到该变量的定义，那么编译器会到其他文件去寻找，若找不到则会编译报错

### 1.2 将 extern 声明放到头文件中，其他文件如果需要使用直接包含该头文件即可

这样就不用每个源文件都对该变量进行一遍声明

变量只能定义一次，而变量可以声明多次

# 二、extern "C"

```cpp
// cpp文件默认定义__cplusplus
#ifdef __cplusplus
extern "C" {
#endif

// ...

#ifdef __cplusplus
}
#endif
```

> extern "C" 使用在 C 与 C++混合开发的方式中，作用是**指示 extern "C"修饰的语句按照 C 语言的方式进行编译和链接**
> 为什么需要指明按照 C 语言的方式进行编译？
>
> - 为正确实现 C++代码调用其他 C 语言代码，C++需要尽量兼容 C
> - C++支持函数重载而 C 不支持函数重载，因此编译 C++函数时会将函数参数类型加入到编译后代码中，以便实现函数重载；而编译 C 函数不会携带函数参数类型(一般只包含函数名)，这就造成函数被 C 编译器和 C++编译器编译后在符号库中的名字不同 --> **C 与 C++编译器对函数的编译处理不相同**

- gcc 编译过程(见[编译与链接](../操作系统/编译与链接.md))

| 编译阶段 |         编译命令          |                 作用                 |
| :------: | :-----------------------: | :----------------------------------: |
|  预处理  | gcc -E hello.c -o hello.i | 编译器将源代码中包含的头文件编译进来 |
|   编译   | gcc -S hello.i -o hello.s |    检查代码规范性并翻译成汇编语言    |
|   汇编   | gcc -c hello.s -o hello.o |       将.s 文件转换为目标文件        |
|   链接   |   gcc hello.o -o hello    |      将目标文件转换为可执行文件      |
